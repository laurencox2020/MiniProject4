---
title: "MiniProject4"
author: "Kate Bruncati, Lauren Cox, Emilia Field"
date: "4/24/2019"
output: 
  html_document:
    code_folding: hide
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(RMySQL)
db <- dbConnect(MySQL(), 
                host = "scidb.smith.edu", 
                user = "mth292", 
                password = "RememberPi", 
                dbname = "imdb")
knitr::opts_chunk$set(connection = db, max.print = 20)
```

```{sql, connection=db}
SELECT t.title, t.production_year, mii2.info AS rating, r.role
FROM cast_info ci
JOIN title t ON ci.movie_id = t.id
JOIN movie_info_idx mii2 ON mii2.movie_id = t.id
JOIN role_type r ON r.id = ci.role_id
WHERE ci.person_id = 3305349
AND t.kind_id = 1
AND mii2.info_type_id = 101
AND r.id = 2
GROUP BY title
ORDER BY rating desc
LIMIT 0,5
```

