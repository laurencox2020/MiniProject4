---
title: 'Leading Ladies in Avengers: From Zero to Hero'
author: "Kate Bruncati, Lauren Cox, Emilia Field"
date: "4/30/2019"
output:
  html_document:
    code_folding: hide
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(RMySQL)
db <- dbConnect(MySQL(), 
                host = "scidb.smith.edu", 
                user = "mth292", 
                password = "RememberPi", 
                dbname = "imdb")
knitr::opts_chunk$set(connection = db, max.print = 20)
```
![Scarlett Johansson (left) and Brie Larson (right)](http://cdn01.cdn.justjared.com/wp-content/uploads/2019/04/brie-ellen/brie-larson-scarlett-johansson-ellen-show-02.JPG)[^1]


**Scarlett Johansson - Top 5 Rated Movies**

```{sql, connection=db, output.var="scarlett"}
SELECT t.title, t.production_year, mii2.info AS rating, r.role, ci.person_id
FROM cast_info ci
JOIN title t ON ci.movie_id = t.id
JOIN movie_info_idx mii2 ON mii2.movie_id = t.id
JOIN role_type r ON r.id = ci.role_id
WHERE (ci.person_id = 3305349) 
AND t.kind_id = 1
AND mii2.info_type_id = 101
AND r.id = 2
GROUP BY title
ORDER BY rating desc
LIMIT 0,5
```

**Brie Larson - Top 5 Rated Movies**

```{sql connection=db, output.var="brie"}
SELECT t.title, t.production_year, mii2.info AS rating, r.role, ci.person_id
FROM cast_info ci
JOIN title t ON ci.movie_id = t.id
JOIN movie_info_idx mii2 ON mii2.movie_id = t.id
JOIN role_type r ON r.id = ci.role_id
WHERE ci.person_id = 3410664 
AND t.kind_id = 1
AND mii2.info_type_id = 101
AND r.id = 2
ORDER BY rating desc
LIMIT 0, 5;
```

```{r, message = FALSE, warning = FALSE}
combining_data <- bind_rows(scarlett, brie) 

avengers <- combining_data %>%
  mutate(title = factor(title,
                        levels = c("The Prestige", "Room", "The Avengers", "Her", "Short Term 12", "Captain America: Civil War", "Captain America: The Winter Soldier", "The Babysitter", "Scott Pilgrim vs. the World", "Harmontown"))) %>%
  arrange(desc(rating))
```

```{r, message = FALSE, warning = FALSE}
rating_plot <- ggplot(avengers, aes(x = title, y = rating, fill = as.character(person_id))) +
  geom_bar(stat = "identity", position = "dodge") +
  theme(axis.text.x = element_text(angle = 90, hjust =1)) +
  ggtitle("Scarlett Johansson vs. Brie Larson") +
  scale_fill_discrete("Actress", labels = c("Scarlett Johansson", "Brie Larson")) 

rating_plot
```


^[This is my repository (https://github.com/laurencox2020/MiniProject4.git)

Word count: `r wordcountaddin::word_count()`

[^1]: Photo by Michael Rozman/Warner Bros, (http://cdn01.cdn.justjared.com/wp-content/uploads/2019/04/brie-ellen/brie-larson-scarlett-johansson-ellen-show-02.JPG)
